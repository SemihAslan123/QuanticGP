{"ast":null,"code":"import _regeneratorRuntime from \"/home/esteban/2emeAnnee/S3/devWeb/QuanticGP10/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/esteban/2emeAnnee/S3/devWeb/QuanticGP10/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport axios from 'axios';\nexport default {\n  name: 'UserBilletsView',\n  data: function data() {\n    return {\n      billets: [] // Initialiser billets comme un tableau vide\n    };\n  },\n  created: function created() {\n    this.fetchBillets();\n  },\n  methods: {\n    logout: function logout() {\n      localStorage.removeItem(\"user\");\n      this.isLoggedIn = false;\n      this.user = null;\n      window.location.reload();\n    },\n    fetchBillets: function fetchBillets() {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var user, response;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              user = JSON.parse(localStorage.getItem('user'));\n              if (!(!user || !user.id)) {\n                _context.next = 4;\n                break;\n              }\n              _this.$router.push({\n                name: 'Login'\n              });\n              return _context.abrupt(\"return\");\n            case 4:\n              _context.prev = 4;\n              _context.next = 7;\n              return axios.get(\"http://localhost:3001/profil/\".concat(user.id, \"/billets\"));\n            case 7:\n              response = _context.sent;\n              _this.billets = response.data; // Réponse attendue : une liste de billets, ou une liste vide\n              _context.next = 15;\n              break;\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](4);\n              console.error('Erreur lors de la récupération des billets :', _context.t0);\n              // Pas besoin de message d'alerte, on gère uniquement l'affichage\n              _this.billets = [];\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[4, 11]]);\n      }))();\n    }\n  },\n  filters: {\n    formatDate: function formatDate(value) {\n      if (!value) return 'Non spécifiée';\n      var date = new Date(value);\n      return date.toLocaleDateString('fr-FR', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","billets","created","fetchBillets","methods","logout","localStorage","removeItem","isLoggedIn","user","window","location","reload","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","JSON","parse","getItem","id","$router","push","abrupt","get","concat","sent","t0","console","error","stop","filters","formatDate","value","date","Date","toLocaleDateString","year","month","day"],"sources":["src/views/ProfilView.vue"],"sourcesContent":["<template>\n  <div class=\"espace-au-dessus\">\n    <div class=\"billet-container\">\n      <h1>Vos Billets</h1>\n      <div v-if=\"billets.length === 0\" class=\"no-billets\">\n        <p>Vous n'avez acheté aucun billet pour le moment.</p>\n      </div>\n      <div v-else class=\"billets-list\">\n        <div class=\"billet-card\" v-for=\"billet in billets\" :key=\"billet.id\">\n          <h2>Billet #{{ billet.id }}</h2>\n          <p><strong>Course :</strong> {{ billet.course_nom || 'Non spécifiée' }}</p>\n          <p v-if=\"billet.hotel_nom\"><strong>Hôtel :</strong> {{ billet.hotel_nom || 'Non spécifié' }}</p>\n          <p v-if=\"billet.date_debut_parking\"><strong>Date de début du parking :</strong> {{ billet.date_debut_parking | formatDate }}</p>\n          <p v-if=\"billet.date_fin_parking\"><strong>Date de fin du parking :</strong> {{ billet.date_fin_parking | formatDate }}</p>\n          <p v-if=\"billet.date_debut_hotel\"><strong>Date de début de l'hôtel :</strong> {{ billet.date_debut_hotel | formatDate }}</p>\n          <p v-if=\"billet.date_fin_hotel\"><strong>Date de fin de l'hôtel :</strong> {{ billet.date_fin_hotel | formatDate }}</p>\n          <p><strong>VIP :</strong> {{ billet.is_vip ? 'Oui' : 'Non' }}</p>\n          <p><strong>Prix total :</strong> {{ billet.prix_total }} €</p>\n          <p><strong>Date de paiement :</strong> {{ billet.date_paiement | formatDate }}</p>\n        </div>\n      </div>\n    </div>\n    <button class=\"logout-button\" @click=\"logout\">Se déconnecter</button>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\n\nexport default {\n  name: 'UserBilletsView',\n  data() {\n    return {\n      billets: [], // Initialiser billets comme un tableau vide\n    };\n  },\n  created() {\n    this.fetchBillets();\n  },\n  methods: {\n    logout() {\n      localStorage.removeItem(\"user\");\n      this.isLoggedIn = false;\n      this.user = null;\n      window.location.reload()\n    },\n    async fetchBillets() {\n      const user = JSON.parse(localStorage.getItem('user'));\n      if (!user || !user.id) {\n        this.$router.push({ name: 'Login' });\n        return;\n      }\n\n      try {\n        const response = await axios.get(`http://localhost:3001/profil/${user.id}/billets`);\n        this.billets = response.data; // Réponse attendue : une liste de billets, ou une liste vide\n      } catch (error) {\n        console.error('Erreur lors de la récupération des billets :', error);\n        // Pas besoin de message d'alerte, on gère uniquement l'affichage\n        this.billets = [];\n      }\n    },\n  },\n  filters: {\n    formatDate(value) {\n      if (!value) return 'Non spécifiée';\n      const date = new Date(value);\n      return date.toLocaleDateString('fr-FR', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric',\n      });\n    },\n  },\n};\n</script>\n\n\n<style scoped>\n.espace-au-dessus {\n  padding-top: 90px;\n}\n\n/* Bouton de déconnexion */\n.logout-button {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 5px;\n  background-color: #f44336;\n  color: white;\n  font-weight: bold;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n}\n\n.logout-button:hover {\n  background-color: #e53935;\n}\n\n.billet-container {\n  width: 100%;\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 20px;\n  background-color: #f8f9fa;\n  border-radius: 8px;\n}\n\nh1 {\n  text-align: center;\n  color: #3498db;\n  margin-bottom: 20px;\n}\n\n.loading {\n  text-align: center;\n  font-size: 1.2em;\n  color: #999;\n}\n\n.no-billets {\n  text-align: center;\n  font-size: 1.2em;\n  color: #e74c3c;\n}\n\n.billets-list {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.billet-card {\n  background-color: #ffffff;\n  padding: 15px;\n  border-radius: 8px;\n  box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);\n}\n\n.billet-card h2 {\n  margin-bottom: 10px;\n  color: #2c3e50;\n}\n\n.billet-card p {\n  margin: 5px 0;\n  color: #34495e;\n  font-size: 1em;\n}\n</style>\n"],"mappings":";;;;;AA2BA,OAAAA,KAAA;AAEA;EACAC,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,OAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,YAAA;EACA;EACAC,OAAA;IACAC,MAAA,WAAAA,OAAA;MACAC,YAAA,CAAAC,UAAA;MACA,KAAAC,UAAA;MACA,KAAAC,IAAA;MACAC,MAAA,CAAAC,QAAA,CAAAC,MAAA;IACA;IACAT,YAAA,WAAAA,aAAA;MAAA,IAAAU,KAAA;MAAA,OAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAR,IAAA,EAAAS,QAAA;QAAA,OAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cACAd,IAAA,GAAAe,IAAA,CAAAC,KAAA,CAAAnB,YAAA,CAAAoB,OAAA;cAAA,MACA,CAAAjB,IAAA,KAAAA,IAAA,CAAAkB,EAAA;gBAAAN,QAAA,CAAAE,IAAA;gBAAA;cAAA;cACAV,KAAA,CAAAe,OAAA,CAAAC,IAAA;gBAAA9B,IAAA;cAAA;cAAA,OAAAsB,QAAA,CAAAS,MAAA;YAAA;cAAAT,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAKAzB,KAAA,CAAAiC,GAAA,iCAAAC,MAAA,CAAAvB,IAAA,CAAAkB,EAAA;YAAA;cAAAT,QAAA,GAAAG,QAAA,CAAAY,IAAA;cACApB,KAAA,CAAAZ,OAAA,GAAAiB,QAAA,CAAAlB,IAAA;cAAAqB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAa,EAAA,GAAAb,QAAA;cAEAc,OAAA,CAAAC,KAAA,iDAAAf,QAAA,CAAAa,EAAA;cACA;cACArB,KAAA,CAAAZ,OAAA;YAAA;YAAA;cAAA,OAAAoB,QAAA,CAAAgB,IAAA;UAAA;QAAA,GAAApB,OAAA;MAAA;IAEA;EACA;EACAqB,OAAA;IACAC,UAAA,WAAAA,WAAAC,KAAA;MACA,KAAAA,KAAA;MACA,IAAAC,IAAA,OAAAC,IAAA,CAAAF,KAAA;MACA,OAAAC,IAAA,CAAAE,kBAAA;QACAC,IAAA;QACAC,KAAA;QACAC,GAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}